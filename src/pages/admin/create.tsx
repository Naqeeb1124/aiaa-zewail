import { useState, useEffect } from 'react';import { useRouter } from 'next/router';import { db } from '../../lib/firebase';import { collection, addDoc, serverTimestamp } from 'firebase/firestore';import AdminGuard from '../../components/AdminGuard';import Navbar from '../../components/Navbar';type FormType = 'announcement' | 'event';export default function CreateItem() {    const router = useRouter();    const { type: queryType } = router.query as { type?: string };    const [type, setType] = useState<FormType>('announcement');    const [loading, setLoading] = useState(false);    // Sync URL query with internal state    useEffect(() => {        if (queryType === 'event' || queryType === 'announcement') {            setType(queryType as FormType);        }    }, [queryType]);    // Common fields    const [title, setTitle] = useState('');    const [imageUrl, setImageUrl] = useState('');    // Announcement specific    const [content, setContent] = useState('');    // Event specific    const [description, setDescription] = useState('');    const [date, setDate] = useState('');    const [time, setTime] = useState('');    const [location, setLocation] = useState('');    const handleSubmit = async (e: React.FormEvent) => {        e.preventDefault();        setLoading(true);        try {            if (type === 'announcement') {                await addDoc(collection(db, 'announcements'), {                    title,                    content,                    imageUrl,                    createdAt: serverTimestamp(),                });                router.push('/admin');            } else {                const dateTime = new Date(`${date}T${time}`);                await addDoc(collection(db, 'events'), {                    title,                    description,                    date: dateTime.toISOString(),                    location,                    imageUrl,                    createdAt: serverTimestamp(),                });                router.push('/admin');            }        } catch (error) {            console.error('Error creating item:', error);            alert('Failed to create item');        } finally {            setLoading(false);        }    };    return (        <AdminGuard>            <div className="min-h-screen bg-slate-900 text-white">                <Navbar />                <div className="pt-32 px-6 max-w-3xl mx-auto">                    <h1 className="text-3xl font-bold mb-8">                        {type === 'announcement' ? 'Post New Announcement' : 'Create New Event'}                    </h1>                    {/* Type switch */}                    <div className="mb-6 flex space-x-4">                        <button                            type="button"                            onClick={() => setType('announcement')}                            className={`px-4 py-2 rounded ${type === 'announcement' ? 'bg-aiaa-blue text-white' : 'bg-slate-800 text-slate-400'} transition-colors`}                        >                            Announcement                        </button>                        <button                            type="button"                            onClick={() => setType('event')}                            className={`px-4 py-2 rounded ${type === 'event' ? 'bg-aiaa-green text-white' : 'bg-slate-800 text-slate-400'} transition-colors`}                        >                            Event                        </button>                    </div>                    <form onSubmit={handleSubmit} className="bg-slate-800 p-8 rounded-2xl border border-slate-800 space-y-6">                        {/* Title */}                        <div>                            <label className="block text-slate-400 mb-2">Title</label>                            <input                                type="text"                                value={title}                                onChange={(e) => setTitle(e.target.value)}                                className="w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 text-white focus:border-aiaa-blue outline-none"                                required                                placeholder="Enter title"                            />                        </div>                        {/* Conditional fields */}                        {type === 'announcement' && (                            <>                                <div>                                    <label className="block text-slate-400 mb-2">Content</label>                                    <textarea                                        value={content}                                        onChange={(e) => setContent(e.target.value)}                                        className="w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 text-white focus:border-aiaa-blue outline-none h-40"                                        required                                        placeholder="Write announcement..."                                    />                                </div>                            </>                        )}                        {type === 'event' && (                            <>                                <div>                                    <label className="block text-slate-400 mb-2">Description</label>                                    <textarea                                        value={description}                                        onChange={(e) => setDescription(e.target.value)}                                        className="w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 text-white focus:border-aiaa-green outline-none h-40"                                        required                                        placeholder="Event details..."                                    />                                </div>                                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">                                    <div>                                        <label className="block text-slate-400 mb-2">Date</label>                                        <input                                            type="date"                                            value={date}                                            onChange={(e) => setDate(e.target.value)}                                            className="w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 text-white focus:border-aiaa-green outline-none"                                            required                                        />                                    </div>                                    <div>                                        <label className="block text-slate-400 mb-2">Time</label>                                        <input                                            type="time"                                            value={time}                                            onChange={(e) => setTime(e.target.value)}                                            className="w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 text-white focus:border-aiaa-green outline-none"                                            required                                        />                                    </div>                                </div>                                <div>                                    <label className="block text-slate-400 mb-2">Location</label>                                    <input                                        type="text"                                        value={location}                                        onChange={(e) => setLocation(e.target.value)}                                        className="w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 text-white focus:border-aiaa-green outline-none"                                        required                                        placeholder="e.g., Room 101, Zewail City"                                    />                                </div>                            </>                        )}                        {/* Image URL (optional) */}                        <div>                            <label className="block text-slate-400 mb-2">Image URL (Optional)</label>                            <input                                type="text"                                value={imageUrl}                                onChange={(e) => setImageUrl(e.target.value)}                                className="w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-3 text-white focus:border-aiaa-blue outline-none"                                placeholder="https://example.com/image.jpg"                            />                        </div>                        <div className="flex justify-end gap-4 pt-4">                            <button                                type="button"                                onClick={() => router.back()}                                className="px-6 py-2 rounded-lg text-slate-400 hover:text-white hover:bg-slate-800 transition-colors"                            >                                Cancel                            </button>                            <button                                type="submit"                                disabled={loading}                                className="px-8 py-2 rounded-lg bg-aiaa-blue text-white font-bold hover:bg-aiaa-blue/80 transition-colors disabled:opacity-50"                            >                                {loading ? (type === 'announcement' ? 'Posting...' : 'Creating...') : (type === 'announcement' ? 'Post Announcement' : 'Create Event')}                            </button>                        </div>                    </form>                </div>            </div>        </AdminGuard>    );}